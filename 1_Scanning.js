const puppeteer = require('puppeteer');
const fs = require('fs');
const xlsx = require('xlsx');
const moment = require('moment');


// –û—Ç–∫—Ä—ã—Ç–∏–µ —Å–∞–π—Ç–∞:
// https://betboom.ru/sport/football

function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

// –ú–∞—Å—Å–∏–≤, –≤ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥—É—Ç —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤—Å–µ –æ—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∞–≤–∫–∏
let resultAllBetsArray = [];


const { exec } = require('child_process');

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
function disableInternet() {
    exec('netsh advfirewall firewall add rule name="Block Internet" dir=out action=block protocol=TCP', (error) => {
        if (error) {
            console.error(`Error disabling internet: ${error}`);
        } else {
            console.log('Internet connection disabled.');
        }
    });
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
function enableInternet() {
    exec('netsh advfirewall firewall delete rule name="Block Internet"', (error) => {
        if (error) {
            console.error(`Error enabling internet: ${error}`);
        } else {
            console.log('Internet connection enabled.');
        }
    });
}

// enableInternet();









/*                                –û–ü–ò–°–ê–ù–ò–ï:

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Å–∫–∞–Ω–∏—Ä—É–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–æ —Å—Ç–∞–≤–∫–∞–º–∏ –Ω–∞ —Ñ—É—Ç–±–æ–ª: betboom.ru/sport/football,
–∏ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –ø–æ–ª—É—á–∞–µ—Ç –º–∞—Å—Å–∏–≤ —Å—Ç–∞–≤–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:

[
...
  [
    '–ê—è–∫—Å',               - –ù–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–π –∫–æ–º–∞–Ω–¥—ã
    '–ì–∞–ª–∞—Ç–∞—Å–∞—Ä–∞–π',        - –ù–∞–∑–≤–∞–Ω–∏–µ –≤—Ç–æ—Ä–æ–π –∫–æ–º–∞–Ω–¥—ã
    '–ó–∞–≤—Ç—Ä–∞ –≤ 01:00',     - –°—Ç—Ä–æ–∫–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–±—ã—Ç–∏—è
    '2,34',               - –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –Ω–∞ –ø–æ–±–µ–¥—É –ø–µ—Ä–≤–æ–π –∫–æ–º–∞–Ω–¥—ã
    '3,85',               - –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –Ω–∞ –Ω–∏—á—å—é
    '2,85',               - –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –Ω–∞ –ø–æ–±–µ–¥—É –≤—Ç–æ—Ä–æ–π –∫–æ–º–∞–Ω–¥—ã
    '30-01-2025 23:58',   - –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
    '31-01-2025 01:00',   - –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è
    '1,03',               - –°–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤ –æ—Å—Ç–∞–ª–æ—Å—å –¥–æ —Å–æ–±—ã—Ç–∏—è (–≤ –¥–µ—Å—è—Ç–∏—á–Ω–æ–π —Å—Å)
    'https://betboom.ru/sport/football/126/239/1344419'  - –°—Å—ã–ª–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏–µ, –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
  ],
...
]

–ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è 2 —Ä–∞–∑–∞ –≤ —Å—É—Ç–∫–∏
–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç–∞–≤–∫–∏ –∏ –∏—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã, –∏ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –∏—Ö –≤ –≤—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª-—Ç–∞–±–ª–∏—Ü—É

–ó–∞—Ç–µ–º, —Å–ª–µ–¥—É—é—â–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ [3_AddScanResNumKoeff.js] - –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è, –∏ –¥–æ–±–∞–≤–ª—è—Ç—å
–≤ –≤—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª-—Ç–∞–±–ª–∏—Ü—É –Ω–æ–º–µ—Ä–∞ –∫–æ–º–∞–Ω–¥ –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É, –∏–∑ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

–í–µ—Å—å —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∞ [2_ProcessingScanning.js]
–û–Ω–∞ –∂–µ –±—É–¥–µ—Ç –∏ —Å–ª–µ–¥–∏—Ç—å –∑–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º –æ–±–æ–∏—Ö —ç—Ç–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º

–ò –∑–∞—Ç–µ–º, –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –Ω—É–∂–Ω–æ–≥–æ —Ñ–∞–π–ª–∞-—Ç–∞–±–ª–∏—Ü—ã, –æ–Ω–∞ –±—É–¥–µ—Ç –≤–Ω–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –Ω–µ—ë, –≤
–æ—Å–Ω–æ–≤–Ω—É—é —Ç–∞–±–ª–∏—Ü—É - MainBetsTable.xlsx

–ü–æ–ø—É—Ç–Ω–æ, –¥–æ–±–∞–≤–ª—è—è —Å–æ–±—ã—Ç–∏—è –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ (–µ—â—ë 4 —Ä–∞–∑–∞), –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –º–∞—Ç—á–∞),
–≤ —Ç–∞–±–ª–∏—Ü—É –∑–∞–¥–∞–Ω–∏–π - TaskTable.xlsx

–ù—É –∏ —Ç–∞–∫–∂–µ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –µ—â—ë –æ–¥–Ω–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –ø–æ–ª –¥–Ω—è

–ù–∞–¥ —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü–µ–π –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–∞-–∞–≤—Ç–æ—Ç–∞–π–º–µ—Ä [5_AutoTimer.js]
–û–Ω–∞ –±—É–¥–µ—Ç –∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤—Å–µ —Å–æ–±—ã—Ç–∏—è, –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–µ –≤ TaskTable.xlsx, –∏ –µ—Å–ª–∏
–ø–æ–¥–æ—à–ª–æ –≤—Ä–µ–º—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞–∫–æ–≥–æ-–ª–∏–±–æ —Å–æ–±—ã—Ç–∏—è, —Ç–æ –æ–Ω–∞ –±—É–¥–µ—Ç –µ–≥–æ –∑–∞–ø—É—Å–∫–∞—Ç—å

–¢.–µ. –ø–æ–ª—É—á–∞–µ—Ç—Å—è, –≤ MainBetsTable.xlsx, –ø–æ—Å–ª–µ –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, –ø–æ—è–≤–∏—Ç—Å—è 
–ø–æ 1 –∑–∞–ø–∏—Å–∏, –Ω–∞ –∫–∞–∂–¥—É—é –Ω–∞–π–¥–µ–Ω–Ω—É—é —Å—Ç–∞–≤–∫—É. –ò —Ç–∞–∫–∂–µ –≤ TaskTable.xlsx –ø–æ—è–≤–∏—Ç—Å—è 5 —Å–æ–±—ã—Ç–∏–π –¥–ª—è —ç—Ç–æ–π —Å—Ç–∞–≤–∫–∏:
4 —Ä–∞–∑–∞ –æ—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –µ—ë –ø–æ –ø—Ä—è–º–æ–π —Å—Å—ã–ª–∫–µ, –∏ 5–π —Ä–∞–∑ - –æ—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø–æ –ø—Ä—è–º–æ–π —Å—Å—ã–ª–∫–µ, –Ω–æ —É–∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–≠—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –±—É–¥—É—Ç —Ç–∞–∫–∂–µ –∑–∞–Ω–æ—Å–∏—Ç—å—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É MainBetsTable.xlsx
–ù–∞–¥ —ç—Ç–∏–º –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –¥—Ä—É–≥–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ [4_ScanningDirectLink.js]








*/


/* –°–ø—Ä–∞–≤–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –º–∞—Ç—á–µ–π:

–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ—É—Ç–±–æ–ª—å–Ω—ã–π –º–∞—Ç—á –¥–ª–∏—Ç—Å—è 90 –º–∏–Ω—É—Ç, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã—Ö –Ω–∞ –¥–≤–∞ —Ç–∞–π–º–∞ –ø–æ 45 –º–∏–Ω—É—Ç –∫–∞–∂–¥—ã–π. 
–ú–µ–∂–¥—É —Ç–∞–π–º–∞–º–∏ –µ—Å—Ç—å 15-–º–∏–Ω—É—Ç–Ω—ã–π –ø–µ—Ä–µ—Ä—ã–≤, –∫–æ–≥–¥–∞ –∫–æ–º–∞–Ω–¥—ã –æ—Ç–¥—ã—Ö–∞—é—Ç –∏ —Ç—Ä–µ–Ω–µ—Ä—ã –º–æ–≥—É—Ç –¥–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–≤–æ–∏–º –∏–≥—Ä–æ–∫–∞–º. 
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –æ–±—â–µ–µ –≤—Ä–µ–º—è, –≤–∫–ª—é—á–∞—è –ø–µ—Ä–µ—Ä—ã–≤, —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 105 –º–∏–Ω—É—Ç.

*/





















/// –í–æ—Ç –∑–¥–µ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –º–∞—Ä–∫–µ—Ä, –±—ã–ª–æ –ª–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º





//
// 1 –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –±—Ä–∞—É–∑–µ—Ä, –∏ –∂–¥—ë—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
//

(async () => {
  // –ó–∞–ø—É—Å–∫–∞–µ–º –±—Ä–∞—É–∑–µ—Ä —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏ –æ–∫–Ω–∞
  const browser = await puppeteer.launch({
    headless: false,
    defaultViewport: {
      width: 650,
      height: 1000
    },
    args: [
      '--window-size=650,1000'
    ]
  });

  // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
  const page = await browser.newPage();

  // –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
  const pages = await browser.pages();

  // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–µ—Ä–≤—É—é (–ø—É—Å—Ç—É—é) —Å—Ç—Ä–∞–Ω–∏—Ü—É
  if (pages.length > 0) {
    await pages[0].close();
  }

  page.on('console', msg => {
    if (msg.type() === 'log') {
      if(msg.text() != "%c color:")
        console.log(`–ë—Ä–∞—É–∑–µ—Ä –≥–æ–≤–æ—Ä–∏—Ç: ${msg.text()}`);
    }
  });

  // –û—Ç–∫—Ä—ã–≤–∞–µ–º —É–∫–∞–∑–∞–Ω–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –∂–¥–µ–º –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
  await page.goto('https://betboom.ru/sport/football', { waitUntil: 'load' });

  console.log("–ó–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã")



  // –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —ç–ª–µ–º–µ–Ω—Ç–∞ 
  // await page.waitForSelector('button.zcABw-a84e8c10.mXIwY-a84e8c10');
  await page.waitForSelector('[class^="zcABw"]');

  // console.log("–ñ–¥—ë–º 5 —Å–µ–∫—É–Ω–¥");
  // await sleep(5000); // –ñ–¥—ë–º 5 —Å–µ–∫—É–Ω–¥ 

  try {
    // –ü—ã—Ç–∞–µ–º—Å—è –¥–æ–∂–¥–∞—Ç—å—Å—è —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ 10 —Å–µ–∫—É–Ω–¥
    await page.waitForSelector('[class^="Ur2bE"]', { timeout: 12000 });

  } catch (error) {
    console.log('–≠–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Ç–µ—á–µ–Ω–∏–µ 12 —Å–µ–∫—É–Ω–¥.');

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å —Ç–µ–∫—Å—Ç–æ–º "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö"
    const isErrorElementPresent = await page.evaluate(() => {
      const errorElement = document.querySelector('[class^="QUM9B"]');
      return errorElement && errorElement.textContent.includes('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö');
    });

    if (isErrorElementPresent) {
      console.log('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –æ—à–∏–±–∫–æ–π');
      await browser.close();
      return;
    } 
  }

  console.log("–•–æ—Ç—è –±—ã –æ–¥–∏–Ω –Ω—É–∂–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∏–ª—Å—è, –∏–¥—ë–º –¥–∞–ª—å—à–µ");

  // –ü–æ–∏—Å–∫ –∏ –∫–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ —Å —Ç–µ–∫—Å—Ç–æ–º "1–¥"
  await page.evaluate(() => {
    const buttons = Array.from(document.querySelectorAll('[class^="zcABw"]'));
    const targetButton = buttons.find(button => button.textContent === '1–¥');
    if (targetButton) {
      targetButton.click();
      console.log("–ö–ª–∏–∫–Ω—É–ª–∏ –ø–æ –∫–Ω–æ–ø–∫–µ '1–¥'");
    }
  });



  // –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –∫–ª–∞—Å—Å–æ–º 'h4qas-a84e8c10'
  await page.waitForSelector('[class^="h4qas"]');

  // –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –∫–ª–∞—Å—Å–æ–º 'h4qas-a84e8c10'
  const elements_arrow_down = await page.$$('[class^="h4qas"]');

  let arrCounterArrDown = 1;

  let parentElement;





  //
  // 2 –†–∞—Å–∫—Ä—ã–≤–∞–µ—Ç —Å–ø–∏—Å–∫–∏
  //

  let inputStringDatabet;
  let childDivs;
  
  for (const element of elements_arrow_down) {
    
    // –í—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–¥ –ø–æ —Ä–∞—Å–∫—Ä—ã—Ç–∏—é —Å–ø–∏—Å–∫–æ–≤, –¥–ª—è –≤—Å–µ—Ö —Å–≤—ë—Ä–Ω—É—Ç—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –ø–µ—Ä–≤–æ–≥–æ,
    // —Ç.–∫. –ø–µ—Ä–≤—ã–π —É–∂–µ —Ä–∞—Å–∫—Ä—ã—Ç
    if (arrCounterArrDown > 1) {
      // if (arrCounterArrDown > 5) break; ///////////////// –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ 5 –ø–µ—Ä–≤—ã—Ö —Å–ø–∏—Å–∫–æ–≤. –ü–æ—Ç–æ–º —É–±—Ä–∞—Ç—å —ç—Ç–æ—Ç –∫–æ–¥

      await element.evaluate(el => {
        el.scrollIntoView();
        el.style.border = '2px solid red'; // –î–æ–±–∞–≤–ª—è–µ–º –∫—Ä–∞—Å–Ω—É—é —Ä–∞–º–∫—É
      });

      await element.evaluate(el => {
        el.scrollIntoView();
        window.scrollBy(0, -300); // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –Ω–∞ 300 –ø–∏–∫—Å–µ–ª–µ–π –≤—ã—à–µ
      });
      // console.log("–ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –¥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è —Å–ø–∏—Å–∫–∞ ‚Ññ " + arrCounterArrDown);    


      // –ù–∞—Ö–æ–¥–∏–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π —ç–ª–µ–º–µ–Ω—Ç —Å –∫–ª–∞—Å—Å–æ–º .A7vA9-a84e8c10 –¥–æ –∫–ª–∏–∫–∞
      parentElement = await element.evaluateHandle(el => {
        return el.closest('[class^="A7vA9"]');
      });

      if (parentElement) {
        await element.click();
        // console.log("–ù–∞–∂–∞–ª–∏ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç —Ä–∞—Å–∫—Ä—ã—Ç–∏—è —Å–ø–∏—Å–∫–∞");

        // –û–∂–∏–¥–∞–µ–º –ø–æ—è–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞ —Å –∫–ª–∞—Å—Å–æ–º .Ur2bE-a84e8c10 –≤–Ω—É—Ç—Ä–∏ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
        await page.waitForFunction(parent => {
          return parent.querySelector('[class^="Ur2bE"]') !== null;
        }, { timeout: 5000 }, parentElement);

        // console.log("–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å");
      }

      await element.evaluate(el => {
        el.style.border = ''; // –£–¥–∞–ª—è–µ–º –∫—Ä–∞—Å–Ω—É—é —Ä–∞–º–∫—É
      });

      console.log("–†–∞—Å–∫—Ä—ã—Ç–∏–µ —Å–ø–∏—Å–∫–∞ ‚Ññ" + arrCounterArrDown + " –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ");
    }
    else {
      // –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å –∫–ª–∞—Å—Å–æ–º .A7vA9-a84e8c10
      parentElement = await page.$('[class^="A7vA9"]');
    }





    //
    // 3 –ü—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –∫–∞–∂–¥–æ–π —Å—Ç–∞–≤–∫–µ –≤ —Å–ø–∏—Å–∫–µ
    //

    // –ò —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –º–∞—Å—Å–∏–≤—ã
    childDivs = await parentElement.$$('[class^="Ur2bE"]');

    console.log("–ü–æ–ª—É—á–∏–ª–∏ –≤—Å–µ —Å—Ç–∞–≤–∫–∏ –≤ —ç—Ç–æ–º —Å–ø–∏—Å–∫–µ. length = " + childDivs.length);
  
    for (const div of childDivs) {
      let info = [];

      // –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç span —Å –∫–ª–∞—Å—Å–æ–º rzys6-a84e8c10
      const spans = await div.$$('[class^="rzys6"]');
      if (spans.length > 0) {
        const span1Text = await page.evaluate(element => element.textContent, spans[0]);
        info.push(span1Text);
      } else {
        info.push(null);
      }

      // –ò–∑–≤–ª–µ–∫–∞–µ–º –≤—Ç–æ—Ä–æ–π —ç–ª–µ–º–µ–Ω—Ç span —Å –∫–ª–∞—Å—Å–æ–º rzys6-a84e8c10
      if (spans.length > 1) {
        const span2Text = await page.evaluate(element => element.textContent, spans[1]);
        info.push(span2Text);
      } else {
        info.push(null);
      }
  
      // –ò–∑–≤–ª–µ–∫–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç time —Å –∫–ª–∞—Å—Å–æ–º dHlnp-a84e8c10
      const timeElement = await div.$('[class^="dHlnp"]');
      const timeText = await page.evaluate(element => element.textContent, timeElement);
      info.push(timeText);
      inputStringDatabet = timeText;

      // –ò–∑–≤–ª–µ–∫–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã span —Å –∫–ª–∞—Å—Å–æ–º do7iP-a84e8c10
      const span3 = await div.$$('[class^="do7iP"]');
      for (let i = 0; i < 3; i++) {
        const spanText = await page.evaluate(element => element.textContent, span3[i]);
        info.push(spanText);
      }

      // console.log("info:");
      // console.log(info);
  
      resultAllBetsArray.push(info);
    }

    break; //////////////////////////////////////////////////// –≠—Ç–æ—Ç –∫–æ–¥ –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π —Ä–∞—Å–∫—Ä—ã—Ç—ã–π —Å–ø–∏—Å–æ–∫

    arrCounterArrDown++;
  }



  // //
  // // –í—ã–≤–æ–¥–∏—Ç –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ 
  // //

  // console.log("resultAllBetsArray: ");
  // console.log(resultAllBetsArray);



  //
  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–∞—Ç—ã
  //  

  function parseEventDate(eventString) {
    let eventDate;
  
    if (eventString.toLowerCase().includes("—Å–µ–≥–æ–¥–Ω—è")) {
      eventDate = moment().startOf('day');
      eventString = eventString.replace(/—Å–µ–≥–æ–¥–Ω—è/i, '').trim();
    } else if (eventString.toLowerCase().includes("–∑–∞–≤—Ç—Ä–∞")) {
      eventDate = moment().add(1, 'days').startOf('day');
      eventString = eventString.replace(/–∑–∞–≤—Ç—Ä–∞/i, '').trim();
    } else {
      console.log("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã");
    }
  
    let time = eventString.match(/(\d{1,2}):(\d{2})/);
    if (time) {
      eventDate.hour(parseInt(time[1], 10)).minute(parseInt(time[2], 10));
    } else {
      console.log("–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏");
    }
  
    return eventDate;
  }
  
  function hoursUntilEvent(eventDate) {
    const now = moment();
    return eventDate.diff(now, 'hours', true);
  }
  
  // –í—Ö–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è –ª–µ–∂–∏—Ç –≤ inputStringDatabet
  
  // let currentDate = moment().format('DD-MM-YYYY HH:mm');
  // let processingDataBet = parseEventDate(inputStringDatabet);
  // let hoursWidthVet = hoursUntilEvent(processingDataBet);
  
  // console.log("–í—Ö–æ–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –≤—Ä–µ–º–µ–Ω–∏: " + inputStringDatabet);
  // console.log("–¢–µ–∫—É—â–∞—è –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è: " + currentDate);
  // console.log("–û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è —Å—Ç–∞–≤–∫–∏: " + processingDataBet.format('DD-MM-YYYY HH:mm'));
  // console.log("–ß–∞—Å–æ–≤ –¥–æ —Å–æ–±—ã—Ç–∏—è: " + hoursWidthVet.toFixed(2));


  for (let i = 0; i < resultAllBetsArray.length; i++) {
    let cur_inputStringDatabet = resultAllBetsArray[i][2];

    let currentDate = moment().format('DD-MM-YYYY HH:mm');
    let processingDataBet = parseEventDate(cur_inputStringDatabet);
    let hoursWidthVet = hoursUntilEvent(processingDataBet);

    resultAllBetsArray[i].push(currentDate)
    resultAllBetsArray[i].push(processingDataBet.format('DD-MM-YYYY HH:mm'))
    resultAllBetsArray[i].push(hoursWidthVet.toFixed(2))
  }




  //
  // –ó–∞–º–µ–Ω—è—é —Ç–æ—á–∫–∏ –Ω–∞ –∑–∞–ø—è—Ç—ã–µ –≤ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞—Ö
  //

  for (let i = 0; i < resultAllBetsArray.length; i++) {
    for(let j = 3; j < 6; j++) {
      resultAllBetsArray[i][j] = resultAllBetsArray[i][j].replace(".", ",")
    }
    resultAllBetsArray[i][8] = resultAllBetsArray[i][8].replace(".", ",")
  }



  //
  // –í—ã—Ç–∞—Å–∫–∏–≤–∞–µ—Ç —Å—Å—ã–ª–∫—É –Ω–∞ —Å–æ–±—ã—Ç–∏–µ, –∏–∑ –∫–∞–∂–¥–æ–π —Å—Ç–∞–≤–∫–∏
  //

  // –í—ã–∫–ª—é—á–∞–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
  // disableInternet();

  console.log("üî¥üî¥üî¥ –û—Ç–∫–ª—é—á–∞–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç!");
  await sleep(3500);



  // –ó–∞–≤—Ç—Ä–∞:


  // –ó–¥–µ—Å—å —Ç–∞–∫–∂–µ –Ω—É–∂–Ω–æ –≤—ã—Ç–∞—â–∏—Ç—å —Å–Ω–∞—á–∞–ª–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ –ª–∏–≥–∏


  // –ó–∞—Ç–µ–º, –¥–ª—è –∫–∞–∂–¥–æ–π –ª–∏–≥–∏ —Ñ—É—Ç–±–æ–ª–∞ –Ω–∞–π—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å —Ä–µ–π—Ç–∏–Ω–≥–æ–º
    // –ö–∞–∫ –º–∏–Ω–∏–º—É–º —Å–Ω–∞—á–∞–ª–∞ –¥–ª—è –£–ï–§–ê
  // –ò –≤—ã—Ç–∞—â–∏—Ç—å –æ—Ç —Ç—É–¥–∞ –≤—Å–µ –ø–æ—Ä—è–¥–∫–æ–≤—ã–µ –Ω–æ–º–µ—Ä–∞, –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—è–º –∫–æ–º–∞–Ω–¥
  // –î–æ–±–∞–≤–∏—Ç—å –∏—Ö –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ —Å–ø–∏—Å–æ–∫ (—É–∂–µ –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –µ–≥–æ —Å—Ñ–æ—Ä–º–∏—Ä—É–µ–º, –∏ –ø—Ä–æ–π–¥—ë–º—Å—è –ø–æ —Å–∞–π—Ç—É –±—É–∫–º–µ–∫–µ—Ä–∞)


  // –î–æ–±–∞–≤–∏—Ç—å –ø–æ—Å—Ç–∏–Ω–≥ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –¢–≥
    // –°–¥–µ–ª–∞—Ç—å –≥—Ä—è–∑–Ω—ã–µ –∏ —á–∏—Å—Ç—ã–µ –ª–æ–≥–∏
    // –°–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ –±—ã –ø–æ—Å–ª–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, —Ñ–∞–π–ª–∏–∫ –∑–∞–≥—Ä—É–∂–∞–ª—Å—è –≤ —ç—Ç–∏ –ª–æ–≥–∏


  // –î–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—á–∫—É —Å —Å–æ–±—ã—Ç–∏—è–º–∏
  // –ù–∞–ø–∏—Å–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ —Ç–∞–π–º–µ—Ä—É, –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å —ç—Ç–∏ —Å–æ–±—ã—Ç–∏—è


  // –í —Ç–∞–±–ª–∏—Ü–µ –≥–ª–∞–≤–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è - —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –Ω–∞ —Å—Ç–∞–≤–∫–∏:
    // –ö1 + –ö2 + –¥–∞—Ç–∞ = —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –ò–î
    // –î–ª—è –∫–∞–∂–¥–æ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –ò–î –º–æ–∂–µ—Ç –±—ã—Ç—å –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫, —Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏
    // –¢–∞–∫–∂–µ, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å, –∞ –º–æ–≥—É—Ç –Ω–µ—Ç 

  // –¢.–µ. –æ—Å—Ç–∞–≤–∏—Ç—å —Å–∫–∞–Ω–µ—Ä —Ç–∞–∫–∏–º –∫–∞–∫–æ–π –æ–Ω –µ—Å—Ç—å, –Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–ª—å—à–µ, –ø–µ—Ä–µ–¥ –≤—ã–≥—Ä—É–∑–∫–æ–π –≤ —Ç–∞–±–ª–∏—Ü—É —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
  // –≥–¥–µ –±—ã –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω—É–∂–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–ª–∞—Å—å


  // –ü–æ–ø—Ä–∞–≤–∏—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–≥–æ —Ñ–∞–π–ª–∏–∫–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
  // –î–æ–±–∞–≤–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    // –≠—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤, –ø–æ —Å—Å—ã–ª–∫–µ –∏–∑ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
    // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–∞—Ç—á–∞, –µ—Å–ª–∏ –ø–æ —Ç–∞–π–º–µ—Ä—É –≤—Ä–µ–º—è —É–∂–µ –ø—Ä–æ—à–ª–æ
    // –ò –ø–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö - –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã + —Ç–µ–∫—É—â–∏–π —Å—á—ë—Ç

  // –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∫ —Å—Ç–∞–≤–∫–µ, –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è

  // –ò –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ —É–∂–µ –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å –≤—Å—é –ø—Ä–æ–≥—Ä–∞–º–º—É –Ω–∞ VPS
    // –ü—Ä–æ–≤–µ—Ä—è—Ç—å
    // –ò –æ—Å—Ç–∞–≤–ª—è—Ç—å –∑–∞–ø—É—â–µ–Ω–Ω–æ–π - —Å–æ–±–∏—Ä–∞—Ç—å –ª–æ–≥–∏

  // –ê –¥–∞–ª—å—à–µ - –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –æ–±—É—á–∞—Ç—å –Ω–µ–π—Ä–æ—Å–µ—Ç—å

  
  

  console.log("–ù–∞—á–∏–Ω–∞–µ–º –ø–∞—Ä—Å–∏–Ω–≥ —Å—Å—ã–ª–æ–∫ —Å–æ–±—ã—Ç–∏–π")

  let massChildDivsLength = childDivs.length;

  for (let i = 0; i < massChildDivsLength; i++) {
    // –ö–∞–∂–¥—É—é –∏—Ç–µ—Ä–∞—Ü–∏—é —Ü–∏–∫–ª–∞ –ø–µ—Ä–µ–Ω–∞—Ö–æ–∂—É —ç–ª–µ–º–µ–Ω—Ç—ã-–∫–Ω–æ–ø–∫–∏ —Å—Ç–∞–≤–æ–∫
    parentElement = await page.$('[class^="A7vA9"]');
    childDivs = await parentElement.$$('[class^="Ur2bE"]');

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –≤–Ω—É—Ç—Ä–∏ —Ç–µ–∫—É—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
    const button = await childDivs[i].$('div[class^="xLmig"]');

    // // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –¥–æ —ç—Ç–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
    // button.scrollIntoView(); 

    if (button) {
      // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ —ç–ª–µ–º–µ–Ω—Ç—É
      await page.evaluate(element => {
        element.scrollIntoView({ block: 'center' });
      }, button);

      // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∏ –ø–æ–ª–æ–∂–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞
      const boundingBox = await button.boundingBox();

      if (boundingBox) {
        // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∫–ª–∏–∫–∞ (100 –ø–∏–∫—Å–µ–ª–µ–π —Å–ø—Ä–∞–≤–∞ –∏ –ø–æ —Ü–µ–Ω—Ç—Ä—É –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏)
        const clickX = boundingBox.x + 100;
        const clickY = boundingBox.y + (boundingBox.height / 2);

        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–π URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        const currentURL = page.url();

        // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–ª–∏–∫–∞ –ø–æ –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º
        await page.mouse.click(clickX, clickY);

        // –û–∂–∏–¥–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è URL
        await page.waitForFunction(`window.location.href !== '${currentURL}'`);

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ URL –≤ –º–∞—Å—Å–∏–≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        resultAllBetsArray[i].push(page.url());

        console.log("–°–æ—Ö—Ä–∞–Ω–∏–ª–∏ URL " + (i+1) + "–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã")

        // await sleep(5000); ////////////////// –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

        await sleep(300);

        // –í–æ–∑–≤—Ä–∞—Ç –Ω–∞ –∏—Å—Ö–æ–¥–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
        await page.goBack();

        await sleep(300);
      }
    }
  }



  console.log("> –í–∫–ª—é—á–∞–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç!");
  // await sleep(2500);


  // –í–∫–ª—é—á–∞–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
  // enableInternet();


  // // –í–∫–ª—é—á–∞—é –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
  // // –î–ª—è Windows
  // exec('netsh interface set interface "Ethernet" admin=enable', (err, stdout, stderr) => {
  //   if (err) {
  //     console.error(`–û—à–∏–±–∫–∞ –≤–∫–ª—é—á–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞: ${stderr}`);
  //     return;
  //   }
  //   console.log("–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –≤–∫–ª—é—á—ë–Ω");
  // });

  // // !@
  // // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º –±—Ä–∞—É–∑–µ—Ä–µ
  // console.log("–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º –±—Ä–∞—É–∑–µ—Ä–µ");
  // await page.setRequestInterception(false);
  // page.removeAllListeners('request');





  // –¢–æ–≥–¥–∞ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—Å—è –Ω–∞ –ª–∏–≥–µ –£–ï–§–ê - –¥–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—Å–µ—Ä –Ω–∞ –æ–¥–∏–Ω –∏–ª–∏ —Å—Ä–∞–∑—É 2 —Å–∞–π—Ç–∞ —Å —Ç–∞–±–ª–∏—Ü–µ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

  // –ò —É–∑–Ω–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª–∏—Ç—Å—è –æ–¥–∏–Ω –º–∞—Ç—á (–∏ —Å–∫–æ–ª—å–∫–æ —É –Ω–µ–≥–æ —á–∞—Å—Ç–µ–π)

  // –ò –¥–æ–±–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –¢–≥


  //
  // –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª
  //

  // // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –º–∞—Å—Å–∏–≤ –≤ —Å—Ç—Ä–æ–∫—É —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
  // const dataString = resultAllBetsArray.map(arr => arr.join(',')).join('\n');

  // // –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ —Ñ–∞–π–ª
  // fs.writeFile('resultScan.txt', dataString, 'utf8', (err) => {
  //   if (err) {
  //     console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏ –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª', err);
  //   } else {
  //     console.log('–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω—ã –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª');
  //   }
  // });



  // //
  // // –§–æ—Ä–º–∏—Ä—É–µ—Ç UID –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏
  // //

  // // UID = –£–Ω–∏–∫–∞–ª—å–Ω—ã–π id

  // for(let i = 0; i < resultAllBetsArray.length; i++) {


  // }



  //
  // –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ —Ç–∞–±–ª–∏—Ü—ã Excel
  //

  // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –∫–Ω–∏–≥—É –∏ –ª–∏—Å—Ç
  const workbook = xlsx.utils.book_new();
  const worksheet = xlsx.utils.aoa_to_sheet([]);

  // –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –ª–∏—Å—Ç, –Ω–∞—á–∏–Ω–∞—è —Å 3-–π —Å—Ç—Ä–æ–∫–∏ –∏ 2-–≥–æ —Å—Ç–æ–ª–±—Ü–∞
  resultAllBetsArray.forEach((row, rowIndex) => {
    row.forEach((cell, colIndex) => {
      xlsx.utils.sheet_add_aoa(worksheet, [[cell]], { origin: { r: rowIndex + 2, c: colIndex + 1 } });
    });
  });

  // –î–æ–±–∞–≤–ª—è–µ–º –ª–∏—Å—Ç –≤ –∫–Ω–∏–≥—É
  xlsx.utils.book_append_sheet(workbook, worksheet, 'Sheet1');

  // –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –∫–Ω–∏–≥—É –≤ —Ñ–∞–π–ª
  xlsx.writeFile(workbook, 'resultScan.xlsx');

  console.log('–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω—ã –≤ Excel —Ñ–∞–π–ª');




  //
  // –í—ã–≤–æ–¥–∏—Ç –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ 
  //

  console.log("resultAllBetsArray: ");
  console.log(resultAllBetsArray);


})();















